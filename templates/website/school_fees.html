{% extends 'website/base.html' %}
{% load static %}

{% block title %}Download School Fees - Dan-Gracious Land High School{% endblock %}

{% block content %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<section class="py-14 bg-white">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-3">Download Your School Fee Bill</h1>
            <p class="text-sm sm:text-base text-gray-600 max-w-2xl mx-auto">Please select the appropriate bill for your child based on their status.</p>
        </div>

        <!-- Fee Options -->
        <div class="grid gap-8 md:grid-cols-2 mb-12">
            <!-- New Student Bill -->
            <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-3xl p-8 border border-blue-200 shadow-lg hover:shadow-xl transition-shadow">
                <div class="mb-4">
                    <span class="inline-flex items-center rounded-full bg-blue-600 text-white px-4 py-1 text-xs font-semibold">NEW INTAKE</span>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">New Student Bill</h3>
                <p class="text-sm text-gray-700 mb-4">For students newly admitted into SSS1 - SSS3.</p>
                
                <div class="bg-white rounded-2xl p-4 mb-6">
                    <p class="text-xs text-gray-600 mb-1">Total Amount</p>
                    <p class="text-3xl font-bold text-blue-600">₦150,000</p>
                </div>

                <button onclick="generatePDF('new')" class="inline-flex w-full justify-center items-center rounded-full bg-blue-600 text-white px-6 py-3 text-sm font-semibold shadow hover:bg-blue-700 transition-colors">
                    <i class="fas fa-download mr-2"></i>
                    Download Bill (PDF)
                </button>
            </div>

            <!-- Returning Student Bill -->
            <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-3xl p-8 border border-green-200 shadow-lg hover:shadow-xl transition-shadow">
                <div class="mb-4">
                    <span class="inline-flex items-center rounded-full bg-green-600 text-white px-4 py-1 text-xs font-semibold">RETURNING STUDENTS</span>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">Returning Student Bill</h3>
                <p class="text-sm text-gray-700 mb-4">For all existing SSS1 - SSS3 students (1st Term 2025/2026).</p>
                
                <div class="bg-white rounded-2xl p-4 mb-6">
                    <p class="text-xs text-gray-600 mb-1">Total Amount</p>
                    <p class="text-3xl font-bold text-green-600">₦80,000</p>
                </div>

                <button onclick="generatePDF('returning')" class="inline-flex w-full justify-center items-center rounded-full bg-green-600 text-white px-6 py-3 text-sm font-semibold shadow hover:bg-green-700 transition-colors">
                    <i class="fas fa-download mr-2"></i>
                    Download Bill (PDF)
                </button>
            </div>
        </div>

        <!-- Bank Account Information -->
        <div class="bg-gradient-to-r from-gray-900 to-gray-800 text-white rounded-3xl p-8 mb-12">
            <h2 class="text-2xl font-bold mb-6">Bank Account Information</h2>
            <div class="grid gap-6 md:grid-cols-3">
                <div class="bg-white/10 rounded-2xl p-6 border border-white/20">
                    <p class="text-xs text-gray-300 mb-1">Bank</p>
                    <p class="text-lg font-semibold">FCMB</p>
                </div>
                <div class="bg-white/10 rounded-2xl p-6 border border-white/20">
                    <p class="text-xs text-gray-300 mb-1">Account Name</p>
                    <p class="text-lg font-semibold">Dangracious Land School LTD</p>
                </div>
                <div class="bg-white/10 rounded-2xl p-6 border border-white/20">
                    <p class="text-xs text-gray-300 mb-1">Account Number</p>
                    <p class="text-lg font-semibold font-mono">2005478300</p>
                </div>
            </div>
        </div>

        <!-- Requirements Section -->
        <div class="bg-white rounded-3xl p-8 border border-gray-200 shadow-sm mb-12">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">Compulsory School Requirements</h2>
            <div class="grid gap-4 md:grid-cols-2">
                <ul class="space-y-3 text-sm text-gray-700">
                    <li class="flex items-start">
                        <i class="fas fa-check text-green-500 mt-1 mr-3"></i>
                        <span>Complete school approved textbook</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-check text-green-500 mt-1 mr-3"></i>
                        <span>Exercise books with school logo</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-check text-green-500 mt-1 mr-3"></i>
                        <span>A pair of black shoes</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-check text-green-500 mt-1 mr-3"></i>
                        <span>Black belt</span>
                    </li>
                </ul>
                <ul class="space-y-3 text-sm text-gray-700">
                    <li class="flex items-start">
                        <i class="fas fa-check text-green-500 mt-1 mr-3"></i>
                        <span>White canvas with white socks for sport</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-check text-green-500 mt-1 mr-3"></i>
                        <span>Jeans skirt for girls (blue or black)</span>
                    </li>
                    <li class="flex items-start">
                        <i class="fas fa-check text-green-500 mt-1 mr-3"></i>
                        <span>Jeans trouser for boys (blue or black)</span>
                    </li>
                </ul>
            </div>
        </div>

        <!-- FAQ Section -->
        <div class="mb-12">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">Frequently Asked Questions</h2>
            <div class="space-y-4">
                <div class="bg-gray-50 rounded-2xl p-6 border border-gray-200">
                    <h3 class="font-semibold text-gray-900 mb-2">What is the difference between the two bills?</h3>
                    <p class="text-sm text-gray-700">The New Student Bill is for students newly admitted into the school, while the Returning Student Bill is for existing students continuing their studies.</p>
                </div>
                <div class="bg-gray-50 rounded-2xl p-6 border border-gray-200">
                    <h3 class="font-semibold text-gray-900 mb-2">When is payment due?</h3>
                    <p class="text-sm text-gray-700">Payment should be made before the resumption date of each term. Please contact the school office for specific deadlines.</p>
                </div>
                <div class="bg-gray-50 rounded-2xl p-6 border border-gray-200">
                    <h3 class="font-semibold text-gray-900 mb-2">Who do I contact if I have payment issues?</h3>
                    <p class="text-sm text-gray-700">Please contact the school office at +234 802 339 5126 or email dangraciouslandschool@gmail.com for any payment-related inquiries.</p>
                </div>
            </div>
        </div>

        <!-- Back Button -->
        <div class="text-center">
            <a href="{% url 'website:admissions' %}" class="inline-flex items-center text-primary hover:text-secondary font-semibold">
                <i class="fas fa-arrow-left mr-2"></i>
                Back to Admissions
            </a>
        </div>
    </div>
</section>

<script>
    // Initialize jsPDF
    const { jsPDF } = window.jspdf;
    
    function generatePDF(type) {
        // Create PDF document
        const doc = new jsPDF('p', 'mm', 'a4');
        const pageWidth = doc.internal.pageSize.getWidth();
        const pageHeight = doc.internal.pageSize.getHeight();
        
        // Add header
        doc.setFontSize(20);
        doc.setTextColor(30, 87, 153);
        doc.text('DAN-GRACIOUS LAND HIGH SCHOOL', pageWidth / 2, 20, { align: 'center' });
        
        doc.setFontSize(12);
        doc.setTextColor(85, 85, 85);
        doc.text('3, Balogun Street, Arobaba Idimu-Lagos', pageWidth / 2, 28, { align: 'center' });
        
        // Add title based on type
        doc.setFontSize(16);
        doc.setTextColor(30, 87, 153);
        if (type === 'new') {
            doc.text('HIGH SCHOOL BILL FOR NEW INTAKE - SSS1-SSS3', pageWidth / 2, 40, { align: 'center' });
        } else {
            doc.text('1ST TERM 2025/2026 - SSS1-SSS3 CLASS BILL', pageWidth / 2, 40, { align: 'center' });
        }
        
        // Add line separator
        doc.setDrawColor(30, 87, 153);
        doc.line(20, 45, pageWidth - 20, 45);
        
        let yPosition = 60;
        
        if (type === 'new') {
            // New student bill content
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            
            // Table headers
            doc.setFillColor(242, 242, 242);
            doc.rect(20, yPosition, pageWidth - 40, 10, 'F');
            doc.setTextColor(30, 87, 153);
            doc.text('ITEM', 25, yPosition + 7);
            doc.text('AMOUNT (₦)', pageWidth - 35, yPosition + 7, { align: 'right' });
            
            yPosition += 15;
            
            // Fee items
            doc.setTextColor(0, 0, 0);
            const newItems = [
                { name: 'ADMISSION FORM', amount: '3,000.00' },
                { name: 'UNIFORMS', amount: '18,000.00' },
                { name: 'SPORT WEAR', amount: '10,000.00' },
                { name: 'CARDIGAN (LONG)', amount: '8,000.00' },
                { name: 'CARDIGAN (SHORT)', amount: '6,500.00' },
                { name: 'HAT (GIRLS)', amount: '5,000.00' },
                { name: 'TUITION FEE', amount: '55,000.00' },
                { name: 'REPORT CARD', amount: '2,000.00' },
                { name: 'MEDICAL', amount: '2,000.00' },
                { name: 'P.T.A (PER TERM)', amount: '1,000.00' },
                { name: 'DEVELOPMENT/EXTRA CURRICULAR', amount: '5,000.00' },
                { name: 'FRIDAY WEAR', amount: '5,000.00' },
                { name: 'LESSON (PER TERM)', amount: '6,000.00' },
                { name: 'CODING AND GRAPHICS (PER TERM)', amount: '10,000.00' },
                { name: 'I.D CARD', amount: '2,000.00' },
                { name: 'XMAS CAROL', amount: '2,000.00' }
            ];
            
            newItems.forEach(item => {
                if (yPosition > pageHeight - 30) {
                    doc.addPage();
                    yPosition = 20;
                }
                
                doc.text(item.name, 25, yPosition);
                doc.text(item.amount, pageWidth - 25, yPosition, { align: 'right' });
                yPosition += 8;
            });
            
            // Totals
            yPosition += 5;
            doc.setDrawColor(200, 200, 200);
            doc.line(20, yPosition, pageWidth - 20, yPosition);
            yPosition += 10;
            
            doc.setTextColor(30, 87, 153);
            doc.setFont(undefined, 'bold');
            doc.text('TOTAL FOR GIRLS', 25, yPosition);
            doc.text('140,500.00', pageWidth - 25, yPosition, { align: 'right' });
            yPosition += 8;
            
            doc.text('TOTAL FOR BOYS', 25, yPosition);
            doc.text('135,500.00', pageWidth - 25, yPosition, { align: 'right' });
            yPosition += 12;
            
            doc.setFontSize(14);
            doc.text('GRAND TOTAL (AVERAGE): ₦150,000.00', pageWidth / 2, yPosition, { align: 'center' });
            
        } else {
            // Returning student bill content
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            
            // Table headers
            doc.setFillColor(242, 242, 242);
            doc.rect(20, yPosition, pageWidth - 40, 10, 'F');
            doc.setTextColor(30, 87, 153);
            doc.text('ITEM', 25, yPosition + 7);
            doc.text('AMOUNT (₦)', pageWidth - 35, yPosition + 7, { align: 'right' });
            
            yPosition += 15;
            
            // Fee items
            doc.setTextColor(0, 0, 0);
            const returningItems = [
                { name: 'TUITION', amount: '50,000.00' },
                { name: 'PTF/EXAMINATION', amount: '3,000.00' },
                { name: 'MEDICAL', amount: '1,000.00' },
                { name: 'PRACTICAL', amount: '1,000.00' },
                { name: 'EXTRA CURRICULAR LESSON (PER TERM)', amount: '5,000.00' },
                { name: 'CODING & GRAPHICS (PER TERM)', amount: '6,000.00' },
                { name: 'XMAS CAROL', amount: '10,000.00' },
                { name: 'OUTSTANDING', amount: '2,000.00' }
            ];
            
            returningItems.forEach(item => {
                if (yPosition > pageHeight - 30) {
                    doc.addPage();
                    yPosition = 20;
                }
                
                doc.text(item.name, 25, yPosition);
                doc.text(item.amount, pageWidth - 25, yPosition, { align: 'right' });
                yPosition += 8;
            });
            
            // Total
            yPosition += 10;
            doc.setDrawColor(30, 87, 153);
            doc.line(20, yPosition, pageWidth - 20, yPosition);
            yPosition += 12;
            
            doc.setFontSize(14);
            doc.setTextColor(30, 87, 153);
            doc.setFont(undefined, 'bold');
            doc.text('TOTAL: ₦80,000.00', pageWidth / 2, yPosition, { align: 'center' });
        }
        
        // Add requirements section
        yPosition += 20;
        if (yPosition > pageHeight - 60) {
            doc.addPage();
            yPosition = 20;
        }
        
        doc.setFontSize(12);
        doc.setTextColor(30, 87, 153);
        doc.setFont(undefined, 'bold');
        doc.text('COMPULSORY SCHOOL REQUIREMENTS:', 20, yPosition);
        yPosition += 8;
        
        doc.setFontSize(10);
        doc.setTextColor(0, 0, 0);
        doc.setFont(undefined, 'normal');
        const requirements = [
            'Complete school approved textbook',
            'Exercise books with school logo',
            'A pair of black shoes',
            'Black belt',
            'White canvas with white socks for sport',
            'Jeans skirt for girls (blue or black)',
            'Jeans trouser for boys (blue or black)'
        ];
        
        requirements.forEach(req => {
            if (yPosition > pageHeight - 20) {
                doc.addPage();
                yPosition = 20;
            }
            
            doc.text('• ' + req, 25, yPosition);
            yPosition += 6;
        });
        
        // Add payment information
        yPosition += 15;
        if (yPosition > pageHeight - 40) {
            doc.addPage();
            yPosition = 20;
        }
        
        doc.setFontSize(12);
        doc.setTextColor(30, 87, 153);
        doc.setFont(undefined, 'bold');
        doc.text('PAYMENT INFORMATION:', 20, yPosition);
        yPosition += 8;
        
        doc.setFontSize(10);
        doc.setTextColor(0, 0, 0);
        doc.setFont(undefined, 'normal');
        doc.text('BANK: FCMB', 25, yPosition);
        yPosition += 6;
        doc.text('ACCOUNT NAME: Dangracious Land School LTD', 25, yPosition);
        yPosition += 6;
        doc.text('ACCOUNT NUMBER: 2005478300', 25, yPosition);
        
        // Add footer
        const footerY = pageHeight - 15;
        doc.setFontSize(8);
        doc.setTextColor(100, 100, 100);
        doc.text('Document generated on: ' + new Date().toLocaleDateString(), pageWidth / 2, footerY, { align: 'center' });
        
        // Save the PDF
        if (type === 'new') {
            doc.save('new-student-fees-2025.pdf');
        } else {
            doc.save('returning-student-fees-2025.pdf');
        }
    }
</script>
{% endblock %}